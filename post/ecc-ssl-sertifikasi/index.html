<!doctype html><html lang=tr dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Linux Sunucuda ECC SSL SertifikasÄ± Ãœretme | Wise</title>
<meta name=keywords content="linux,ssl,security,ecc,elliptic curve"><meta name=description content="GiriÅŸ ve Ã–zet BugÃ¼n sizlerle yÃ¶nettiÄŸiniz bir web sitesi veya uygulama sunucusu ile ziyaretÃ§ileriniz arasÄ±ndaki trafiÄŸin gizli/gÃ¼venilir ve doÄŸrulanabilir olmasÄ±nÄ± saÄŸlamak iÃ§in SSL sertifikasÄ± Ã¼retmeyi Ã¶ÄŸreneceÄŸiz. ÃœrettiÄŸiniz sertifikayÄ± nasÄ±l ve hangi konfigÃ¼rasyon ile deploy edeceÄŸinizi Ã¶nceki yazÄ±larÄ±mda anlatmÄ±ÅŸtÄ±m. Bu yazÄ±da ise az ekmek Ã§ok kÃ¶fte denklemini nasÄ±l kurabileceÄŸimizi yani daha hÄ±zlÄ± ve daha gÃ¼venli bir SSL sertifikasÄ± Ã¼retmeyi gÃ¶stereceÄŸim. Normalde Let&rsquo;s Encrypt&rsquo;in ACME protokolÃ¼ne aÅŸina iseniz (yazÄ±nÄ±n yazÄ±ldÄ±ÄŸÄ± tarih itibariyle) RSA asimetrik anahtar yapÄ±sÄ± ile 1024-4098 (Ã§ok zorlarsanÄ±z belki 8196) bitlik bir sertifika Ã¼rettirmeniz ve bunu gÃ¶rece olarak 90 gÃ¼n kullanmanÄ±z mÃ¼mkÃ¼ndÃ¼r."><meta name=author content="Wise"><link rel=canonical href=https://wiseweb-works.github.io/blog/post/ecc-ssl-sertifikasi/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.342dd4efd6228f58cff35ccd173d34ed0eb821b1b593eaceceeb0d64db7234c1.css integrity="sha256-NC3U79Yij1jP81zNFz007Q64IbG1k+rOzusNZNtyNME=" rel="preload stylesheet" as=style><link rel=icon href=https://wiseweb-works.github.io/blog/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wiseweb-works.github.io/blog/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wiseweb-works.github.io/blog/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://wiseweb-works.github.io/blog/favicons/apple-touch-icon.png><link rel=mask-icon href=https://wiseweb-works.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=tr href=https://wiseweb-works.github.io/blog/post/ecc-ssl-sertifikasi/><link rel=alternate hreflang=en href=https://wiseweb-works.github.io/blog/en/post/ecc-ssl-sertifikasi/><link rel=alternate hreflang=de href=https://wiseweb-works.github.io/blog/de/post/ecc-ssl-sertifikasi/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Linux Sunucuda ECC SSL SertifikasÄ± Ãœretme"><meta property="og:description" content="GiriÅŸ ve Ã–zet BugÃ¼n sizlerle yÃ¶nettiÄŸiniz bir web sitesi veya uygulama sunucusu ile ziyaretÃ§ileriniz arasÄ±ndaki trafiÄŸin gizli/gÃ¼venilir ve doÄŸrulanabilir olmasÄ±nÄ± saÄŸlamak iÃ§in SSL sertifikasÄ± Ã¼retmeyi Ã¶ÄŸreneceÄŸiz. ÃœrettiÄŸiniz sertifikayÄ± nasÄ±l ve hangi konfigÃ¼rasyon ile deploy edeceÄŸinizi Ã¶nceki yazÄ±larÄ±mda anlatmÄ±ÅŸtÄ±m. Bu yazÄ±da ise az ekmek Ã§ok kÃ¶fte denklemini nasÄ±l kurabileceÄŸimizi yani daha hÄ±zlÄ± ve daha gÃ¼venli bir SSL sertifikasÄ± Ã¼retmeyi gÃ¶stereceÄŸim. Normalde Let&rsquo;s Encrypt&rsquo;in ACME protokolÃ¼ne aÅŸina iseniz (yazÄ±nÄ±n yazÄ±ldÄ±ÄŸÄ± tarih itibariyle) RSA asimetrik anahtar yapÄ±sÄ± ile 1024-4098 (Ã§ok zorlarsanÄ±z belki 8196) bitlik bir sertifika Ã¼rettirmeniz ve bunu gÃ¶rece olarak 90 gÃ¼n kullanmanÄ±z mÃ¼mkÃ¼ndÃ¼r."><meta property="og:type" content="article"><meta property="og:url" content="https://wiseweb-works.github.io/blog/post/ecc-ssl-sertifikasi/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-03-20T00:00:00+00:00"><meta property="article:modified_time" content="2024-04-16T22:17:43+02:00"><meta property="og:site_name" content="Wise Web Works"><meta name=twitter:card content="summary"><meta name=twitter:title content="Linux Sunucuda ECC SSL SertifikasÄ± Ãœretme"><meta name=twitter:description content="GiriÅŸ ve Ã–zet BugÃ¼n sizlerle yÃ¶nettiÄŸiniz bir web sitesi veya uygulama sunucusu ile ziyaretÃ§ileriniz arasÄ±ndaki trafiÄŸin gizli/gÃ¼venilir ve doÄŸrulanabilir olmasÄ±nÄ± saÄŸlamak iÃ§in SSL sertifikasÄ± Ã¼retmeyi Ã¶ÄŸreneceÄŸiz. ÃœrettiÄŸiniz sertifikayÄ± nasÄ±l ve hangi konfigÃ¼rasyon ile deploy edeceÄŸinizi Ã¶nceki yazÄ±larÄ±mda anlatmÄ±ÅŸtÄ±m. Bu yazÄ±da ise az ekmek Ã§ok kÃ¶fte denklemini nasÄ±l kurabileceÄŸimizi yani daha hÄ±zlÄ± ve daha gÃ¼venli bir SSL sertifikasÄ± Ã¼retmeyi gÃ¶stereceÄŸim. Normalde Let&rsquo;s Encrypt&rsquo;in ACME protokolÃ¼ne aÅŸina iseniz (yazÄ±nÄ±n yazÄ±ldÄ±ÄŸÄ± tarih itibariyle) RSA asimetrik anahtar yapÄ±sÄ± ile 1024-4098 (Ã§ok zorlarsanÄ±z belki 8196) bitlik bir sertifika Ã¼rettirmeniz ve bunu gÃ¶rece olarak 90 gÃ¼n kullanmanÄ±z mÃ¼mkÃ¼ndÃ¼r."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wiseweb-works.github.io/blog/post/"},{"@type":"ListItem","position":2,"name":"Linux Sunucuda ECC SSL SertifikasÄ± Ãœretme","item":"https://wiseweb-works.github.io/blog/post/ecc-ssl-sertifikasi/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Linux Sunucuda ECC SSL SertifikasÄ± Ãœretme","name":"Linux Sunucuda ECC SSL SertifikasÄ± Ãœretme","description":"GiriÅŸ ve Ã–zet BugÃ¼n sizlerle yÃ¶nettiÄŸiniz bir web sitesi veya uygulama sunucusu ile ziyaretÃ§ileriniz arasÄ±ndaki trafiÄŸin gizli/gÃ¼venilir ve doÄŸrulanabilir olmasÄ±nÄ± saÄŸlamak iÃ§in SSL sertifikasÄ± Ã¼retmeyi Ã¶ÄŸreneceÄŸiz. ÃœrettiÄŸiniz sertifikayÄ± nasÄ±l ve hangi konfigÃ¼rasyon ile deploy edeceÄŸinizi Ã¶nceki yazÄ±larÄ±mda anlatmÄ±ÅŸtÄ±m. Bu yazÄ±da ise az ekmek Ã§ok kÃ¶fte denklemini nasÄ±l kurabileceÄŸimizi yani daha hÄ±zlÄ± ve daha gÃ¼venli bir SSL sertifikasÄ± Ã¼retmeyi gÃ¶stereceÄŸim. Normalde Let\u0026rsquo;s Encrypt\u0026rsquo;in ACME protokolÃ¼ne aÅŸina iseniz (yazÄ±nÄ±n yazÄ±ldÄ±ÄŸÄ± tarih itibariyle) RSA asimetrik anahtar yapÄ±sÄ± ile 1024-4098 (Ã§ok zorlarsanÄ±z belki 8196) bitlik bir sertifika Ã¼rettirmeniz ve bunu gÃ¶rece olarak 90 gÃ¼n kullanmanÄ±z mÃ¼mkÃ¼ndÃ¼r.","keywords":["linux","ssl","security","ecc","elliptic curve"],"articleBody":"GiriÅŸ ve Ã–zet BugÃ¼n sizlerle yÃ¶nettiÄŸiniz bir web sitesi veya uygulama sunucusu ile ziyaretÃ§ileriniz arasÄ±ndaki trafiÄŸin gizli/gÃ¼venilir ve doÄŸrulanabilir olmasÄ±nÄ± saÄŸlamak iÃ§in SSL sertifikasÄ± Ã¼retmeyi Ã¶ÄŸreneceÄŸiz. ÃœrettiÄŸiniz sertifikayÄ± nasÄ±l ve hangi konfigÃ¼rasyon ile deploy edeceÄŸinizi Ã¶nceki yazÄ±larÄ±mda anlatmÄ±ÅŸtÄ±m. Bu yazÄ±da ise az ekmek Ã§ok kÃ¶fte denklemini nasÄ±l kurabileceÄŸimizi yani daha hÄ±zlÄ± ve daha gÃ¼venli bir SSL sertifikasÄ± Ã¼retmeyi gÃ¶stereceÄŸim. Normalde Letâ€™s Encryptâ€™in ACME protokolÃ¼ne aÅŸina iseniz (yazÄ±nÄ±n yazÄ±ldÄ±ÄŸÄ± tarih itibariyle) RSA asimetrik anahtar yapÄ±sÄ± ile 1024-4098 (Ã§ok zorlarsanÄ±z belki 8196) bitlik bir sertifika Ã¼rettirmeniz ve bunu gÃ¶rece olarak 90 gÃ¼n kullanmanÄ±z mÃ¼mkÃ¼ndÃ¼r. Fakat bu kadar bÃ¼yÃ¼k bir anahtarÄ±n Ã¼retilmesi, Ã¼rettikten sonra TLS handshake sÄ±rasÄ±nda kullanÄ±lmasÄ± ve ziyaretÃ§ilerin kullandÄ±ÄŸÄ± cihazlar ile uyumlu olmasÄ± Ã§oÄŸu senaryoda sorun Ã§Ä±karmaktadÄ±r. Ã–rneÄŸin 2048 bit yerine 4096 bit kullanÄ±ldÄ±ÄŸÄ± zaman bazÄ± denemelerimde 0.4-0.8 sn daha uzun handshake sÃ¼releri ile karÅŸÄ± karÅŸÄ±ya kalÄ±yorum. Sadece handshake in bu kadar uzamasÄ± sorun deÄŸilmiÅŸ gibi sunucuya da ekstra bir yÃ¼k bindiriyor. Fakat 4096 bit RSA yerine 384 bit ECC sertifikasÄ± Ã¼rettiÄŸiniz zaman Ã§ok daha hÄ±zlÄ± bir sertifikaya sahip olduÄŸunuz gibi aynÄ± zamanda da 7680 bit RSAâ€™ya (Ã¶yle bir boyut olsaydÄ±) eÅŸit bir gÃ¼venlik elde ediyorsunuz.\nPeki iyi gÃ¼zel anlattÄ±n da bu iÅŸin amasÄ± nerede dediÄŸinizi duyar gibiyim. Sizi Ã¼zeceÄŸim fakat bu iÅŸin amasÄ± yok. OlmamasÄ±nÄ±n sebebi ise iÅŸin arka plandaki matematikte saklÄ±. KÄ±saca her iki sertifika Ã¼retim ve kullanÄ±mÄ±ndaki ufak farklardan bahsedip, bunlarÄ±n nasÄ±l ve neden bÃ¼yÃ¼k farklara neden olduÄŸunu aÃ§Ä±klayÄ±p son kÄ±sÄ±mda da bonus olarak baÅŸlÄ±kta yazmayan bir ÅŸeyden bahsedeceÄŸim. (Sonuna kadar okumanÄ±z gerekecek bonus iÃ§in :D)\nhttps://www.globalsign.com/en/blog/elliptic-curve-cryptography (EriÅŸim Tarihi: 08.04.2023) ECC SertifikasÄ±nÄ±n Ã¼retim sÃ¼reci Ã–ncelikle (her zaman olduÄŸu gibi) iÃ§inde bulunduÄŸumuz Linux sÃ¼rÃ¼mÃ¼nÃ¼n paket yÃ¶neticisi ile son gÃ¼ncellemeleri konsol Ã¼zerinden yÃ¼klememiz gerekmektedir.\nUbuntu iÃ§in: sudo apt update \u0026\u0026 sudo apt upgrade -y Fedora iÃ§in: sudo yum update -y Arch Linux iÃ§in: sudo pacman -Syyu GÃ¼ncellemeler yÃ¼klendikten sonra ise sunucunuzdaki (Benim olayÄ±mda Ubuntu) nginx servisini (ki bu servis dÄ±ÅŸarÄ±dan HTTP/HTTPS baÄŸlantÄ±larÄ± almanÄ±za yarayan servistir) yapÄ±landÄ±rmaya baÅŸlÄ±yoruz. Ã–ncelikle Ã§ok karÄ±ÅŸtÄ±rÄ±lmasÄ± nedeniyle belirtmek gerekir ki apache, nginx ve litespeed servisleri aynÄ± iÅŸi yapan farklÄ± servislerdir. Ben yÃ¶netimi daha kolay ve topluluk desteÄŸi daha Ã§ok diye NGINXâ€™i terchi ettim.\nÃ–zel anahtarÄ± oluÅŸturalÄ±m Ä°lk olarak, OpenSSL ile Ã¶zel anahtarÄ± oluÅŸturuyoruz. KullanacaÄŸÄ±mÄ±z OpenSSL komutu ecparam (EC parametre manipÃ¼lasyonu) ve konfigÃ¼rasyon parametrelerini bu komuta geÃ§irmek iÃ§in:\nopenssl ecparam -genkey -name secp384r1 -out privkey.pem -genkey seÃ§eneÄŸi, OpenSSLâ€™ye bir EC anahtarÄ± oluÅŸturmasÄ±nÄ± sÃ¶yler. -name parametresi OpenSSLâ€™ye hangi eÄŸrinin kullanÄ±lacaÄŸÄ±nÄ± sÃ¶yler. -out parametresi OpenSSLâ€™ye Ã§Ä±ktÄ±yÄ± bir dosyaya yazmasÄ±nÄ± sÃ¶yler. OpenSSLâ€™nin Ã§Ä±ktÄ±sÄ±nÄ± varsayÄ±lan olarak PEM biÃ§iminde yazdÄ±ÄŸÄ±nÄ± unutmayÄ±n. EC anahtarlarÄ±nÄ± iÅŸleyen ec komutuyla OpenSSLâ€™nin doÄŸru ÅŸeyi yaptÄ±ÄŸÄ±nÄ± kontrol edebiliriz:\nopenssl ec -in privkey.pem -noout -text -in girdi dosyasÄ±dÄ±r -noout, OpenSSLâ€™ye anahtarÄ± Ã§Ä±karmamasÄ±nÄ± sÃ¶yler, bu da privkey.pemâ€™i stdoutâ€™a anlamsÄ±zca yazdÄ±rÄ±r. -text, OpenSSLâ€™ye anahtar hakkÄ±ndaki bilgileri dÃ¼z metin biÃ§iminde yazmasÄ±nÄ± sÃ¶yler Her ÅŸey yolunda giderse ve anahtar doÄŸru ÅŸekilde oluÅŸturulduysa, OpenSSL aÅŸaÄŸÄ±dakine benzer bir ÅŸey gÃ¶sterecektir:\nread EC key Private-Key: (384 bit) priv: [gizli] pub: [gizli] ASN1 OID: secp384r1 NIST CURVE: P-384 Bu, anahtarÄ±n P-384 eÄŸrisi ile oluÅŸturulduÄŸunu doÄŸrular. Neden P-384 yerine P-512 kullanmÄ±yoruz derseniz Letâ€™s Encrypt ekliptik eÄŸrilerde 384 bitten daha yÃ¼ksek olursa imzalamÄ±yor ve Google Chrome gibi modern tarayÄ±cÄ±lar 512 bitlik ekliptik eÄŸrileri kullanan internet sitelerini geÃ§ersiz olarak iÅŸaretliyor. KÄ±sa cevap bu.\nSertifika iÃ§in OpenSSL yapÄ±landÄ±rmasÄ± oluÅŸturalÄ±m Åimdi TLS sertifikasÄ± almak istediÄŸimiz etki alanÄ±na Ã¶zgÃ¼ parametreleri iÃ§eren bir OpenSSL yapÄ±landÄ±rma dosyasÄ± oluÅŸturmalÄ±yÄ±z. Bu Ã¶rnekte, bir openssl.cnf dosyasÄ±na aÅŸaÄŸÄ±daki konfigÃ¼rasyonu gireceÄŸiz:\n[ req ] prompt = no encrypt_key = no default_md = sha512 distinguished_name = dname req_extensions = reqext [ dname ] CN = example.com emailAddress = admin@example.com [ reqext ] subjectAltName = DNS:example.com, DNS:www.example.com Bu yapÄ±landÄ±rma seÃ§eneklerinin kÄ±sa bir aÃ§Ä±klamasÄ±:\nGerekli [ req ] bÃ¶lÃ¼mÃ¼nde:\nprompt = no, OpenSSLâ€™ye yapÄ±landÄ±rma dosyasÄ±ndan olabildiÄŸince fazla yapÄ±landÄ±rma almasÄ±nÄ± sÃ¶yler encrypt_key = no, OpenSSLâ€™ye Ã¶zel anahtarÄ± bir parola ile ÅŸifrelememesini sÃ¶yler. (Åifreli Ã¶zel anahtarlar Nginx tarafÄ±ndan desteklenir, ancak ben onlarÄ± kullanmÄ±yorum.) default_md = sha512, OpenSSLâ€™ye CSRâ€™yi SHA512 ile imzalamasÄ±nÄ± sÃ¶yler. (BildiÄŸim kadarÄ±yla, Letâ€™s Encrypt, imzalarÄ± iÃ§in yalnÄ±zca SHA256â€™lÄ± RSAâ€™yÄ± destekler, ancak bu, CSRâ€™de daha gÃ¼Ã§lÃ¼ ÅŸifreleme kullanamayacaÄŸÄ±mÄ±z anlamÄ±na gelmez.) distinguished_name = dname, OpenSSLâ€™ye AyÄ±rt Edici Ad yapÄ±landÄ±rma seÃ§enekleri iÃ§in bir [ dname ] bÃ¶lÃ¼mÃ¼ aramasÄ±nÄ± sÃ¶yler. req_extensions = reqext, OpenSSLâ€™ye, Konu Alternatif AdlarÄ±nÄ±n (SANâ€™lar) yapÄ±landÄ±rÄ±lmak istenen uzantÄ±lar iÃ§in yapÄ±landÄ±rma seÃ§eneklerinde bir [ reqext ] bÃ¶lÃ¼mÃ¼ aramasÄ±nÄ± sÃ¶yler. AyÄ±rt Edici Ad [ dname ] bÃ¶lÃ¼mÃ¼nde:\nCN = example.com, sertifikanÄ±n Ortak AdÄ±nÄ± belirtir. emailAddress = admin@example.com e-posta adresiniz belirgin olmalÄ±dÄ±r. Ä°stenen UzantÄ±lar [ reqext ] bÃ¶lÃ¼mÃ¼nde, konuAltName, sertifika iÃ§in SANâ€™larÄ±n listesini saÄŸlar. (Chrome, v58â€™den itibaren, Ortak AdÄ±n SANâ€™lar listesine dahil edilmesini gerektirir). Letâ€™s Encrypt v2, joker alan adlarÄ±nÄ± destekler, bu nedenle bu Ã¶rnekte, apeks dÄ±ÅŸÄ±ndaki ana bilgisayarlar iÃ§in tek dÃ¼zeyli bir joker karakter kullanabilirsiniz (*.example.com).\nSertifika Ä°mzalama Ä°steÄŸi OluÅŸturalÄ±m Ä°stemci tarafÄ±ndaki son adÄ±m, OpenSSL kullanarak Sertifika Ä°mzalama Talebi oluÅŸturmaktÄ±r, ardÄ±ndan bunu imzalamak iÃ§in Letâ€™s Encryptâ€™e ileteceÄŸiz ve imzalÄ± sertifikayÄ± geri alacaÄŸÄ±z.\nBir CSR oluÅŸturmak iÃ§in gereken OpenSSL komutu req â€˜dir.\nopenssl req -new -config openssl.cnf -key privkey.pem -out csr.pem -new, OpenSSLâ€™ye bir CSR oluÅŸturduÄŸumuzu sÃ¶yler (ve mevcut bir CSRâ€™yi incelemeyiz) -config openssl.cnf, yukarÄ±da oluÅŸturduÄŸumuz yapÄ±landÄ±rma dosyasÄ±nÄ± belirtir -key privkey.pem, yukarÄ±da oluÅŸturduÄŸumuz Ã¶zel anahtarÄ± belirtir -out csr.pem OpenSSLâ€™ye CSRâ€™yi bir Ã§Ä±ktÄ± dosyasÄ±na yazmasÄ±nÄ± sÃ¶yler (stdout yerine) CSRâ€™yi doÄŸru ÅŸekilde oluÅŸturduÄŸumuzu doÄŸrulayabiliriz:\nopenssl req -in csr.pem -noout -text -verify -verify OpenSSLâ€™nin CSRâ€™deki imzayÄ± doÄŸrulamasÄ±nÄ± ister Bu, Ã§Ä±ktÄ±da beklenen ÅŸu sonuÃ§larÄ± Ã¼retmelidir:\nverify OK Certificate Request: Data: Version: 1 (0x0) Subject: CN = example.com, emailAddress = admin@example.com Subject Public Key Info: Public Key Algorithm: id-ecPublicKey Public-Key: (384 bit) pub: [gizli] ASN1 OID: secp384r1 NIST CURVE: P-384 Attributes: Requested Extensions: X509v3 Subject Alternative Name: DNS:example.com, DNS:www.example.com Signature Algorithm: ecdsa-with-SHA512 [gizli] Letâ€™s Encryptâ€™ten sertifikamÄ±zÄ± imzalamasÄ±nÄ± isteyin Son adÄ±m, CSRâ€™yi bir ACME istemcisiyle Letâ€™s Encryptâ€™e imzalamasÄ± iÃ§in gÃ¶ndermektir, bu iÅŸ iÃ§in certbot en yaygÄ±n istemcidir.\nCertbot istemcisine iletilen komut satÄ±rÄ± seÃ§enekleri, kurulumumuza, alan adÄ±mÄ±zÄ±n kayÄ±tlÄ± olduÄŸu kiÅŸiye vb. baÄŸlÄ± olarak deÄŸiÅŸir. Genellikle certonly komutunu kullanmamÄ±z gerekir ve asterisks (*) kullandÄ±ysanÄ±z certbot DNS eklentilerinden birini kullanmanÄ±z gerekir.\nÃ–rneÄŸin, example.com alan adÄ± Cloudflareâ€™de kayÄ±tlÄ±ysa, son derece uygun olan ve sÃ¼rece manuel mÃ¼dahale gerektirmeyen doÄŸrulamayÄ± iÅŸlemek iÃ§in ilgili eklentiyi kullanabiliriz. (Cloudflare eklentisini gizli token bilgileriyle yapÄ±landÄ±rmak bu makalenin kapsamÄ± dÄ±ÅŸÄ±ndadÄ±r.)\nHer ÅŸeyin yolunda olduÄŸundan emin olmak iÃ§in Ã¶nce --dry-run ile dÃ¼zgÃ¼n sonuÃ§ alÄ±nacaÄŸÄ±ndan emin olunmasÄ± genellikle tavsiye edilir.\ncertbot nginx certonly --dry-run --domain \"example.com\" --domain \"www.example.com\" --csr csr.pem HatalÄ± iÅŸlemeleri Ã¶nlemek iÃ§in karakterlerin etrafÄ±nda tÄ±rnak iÅŸaretleri gereklidir ve genel olarak bunlar iyi bir fikirdir. --csr csr.pem certbotâ€™a zaten bir sertifikamÄ±z olduÄŸunu ve bizim iÃ§in imzalamasÄ± iÃ§in Letâ€™s Encryptâ€™e ihtiyacÄ±mÄ±z olduÄŸunu sÃ¶yler. Certbot istemcisi, komut satÄ±rÄ±nda istenen alan adlarÄ± listesinin sertifikada listelenen alan adlarÄ±yla eÅŸleÅŸip eÅŸleÅŸmediÄŸini kontrol edecek ve alan adÄ±nÄ±n bize ait olduÄŸunu doÄŸrulamak iÃ§in Certbot NGINX eklentisini kullanacak ve herhangi bir sorun olup olmadÄ±ÄŸÄ±nÄ± bize bildirecektir.\nHiÃ§bir ÅŸey yanlÄ±ÅŸ deÄŸilse, size ÅŸunu sÃ¶yleyecektir:\nIMPORTANT NOTES: - The dry run was successful. GerÃ§ek komut hemen aÅŸaÄŸÄ±daki gibidir:\ncertbot nginx certonly --domain \"example.com\" --domain \"www.example.com\" --csr csr.pem (Uzun) bir gecikmeden sonra, istemci Ã§Ä±ktÄ± olarak ÅŸunlarÄ± Ã¼retecektir:\nÄ°mzalÄ± sertifika: 0000_cert.pem KÃ¶k ve ara sertifikalar: 0000_chain.pem Sertifika + ara Ã¼rÃ¼nler: 0001_chain.pem Bu noktada, CSR csr.pem silinebilir. Merak ediyorsak, x509 komutunu kullanarak istemci tarafÄ±ndan OpenSSL ile dÃ¶ndÃ¼rÃ¼len sertifikalarÄ± inceleyebiliriz:\nopenssl x509 -in 0001_chain.pem -noout -text Ne yazÄ±k ki, yukarÄ±da aÃ§Ä±klandÄ±ÄŸÄ± gibi Letâ€™s Encryptâ€™in sertifikamÄ±zÄ± bir SHA256 imzasÄ±yla imzaladÄ±ÄŸÄ±nÄ± keÅŸfedeceÄŸiz. (Daha gÃ¼venli olmasÄ±nÄ±n yanÄ± sÄ±ra, SHA512, modern 64-bit CPUâ€™larda SHA256â€™dan daha iyi performans gÃ¶sterir.) Ancak aÃ§Ä±k anahtarÄ±mÄ±z yine de ECDSA kullanmalÄ±dÄ±r.\nBu dosyalar sÄ±radan deÄŸildir, bu yÃ¼zden onlarÄ± daha bilgilendirici bir ÅŸekilde taÅŸÄ±malÄ± ve dÃ¼zenlemeliyiz.\nDebian Linuxâ€™ta, Ã¶zel anahtarÄ±mÄ± /home/KULLANICI_ADI/SSL/private/example.com/privkey.pem iÃ§inde tutarak etki alanlarÄ±m iÃ§in alt dizinler oluÅŸturmayÄ± seviyorum ve sertifikalar:\n/home/KULLANICI_ADI/SSL/certs/example.com/cert.pem /home/KULLANICI_ADI/SSL/certs/example.com/chain.pem /home/KULLANICI_ADI/SSL/certs/example.com/fullchain.pem SON Her ÅŸeyi doÄŸru yaptÄ±ysak, sertifikayÄ± Chrome gibi bir web tarayÄ±cÄ±sÄ± ile incelediÄŸimizde, bunun bir EC sertifikasÄ± olduÄŸunu onaylayacaktÄ±r:\nhttps://dev.to/benjaminblack/obtaining-an-elliptic-curve-dsa-certificate-with-lets-encrypt-51bc (EriÅŸim Tarihi: 08.04.2023) Mozilla GÃ¶zlemevi de bize A+ notu verecek!\nhttps://dev.to/benjaminblack/obtaining-an-elliptic-curve-dsa-certificate-with-lets-encrypt-51bc (EriÅŸim Tarihi: 08.04.2023) AyrÄ±ca SSL Labsâ€™Ä±n rapor sonucunda 384 Bitlik bir ECC sertifikasÄ±â€™nÄ±n kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rebiliyoruz.\nSSL Labs Test Sonucu NOT: Bu yazÄ±da Benjamin Blackâ€˜in aynÄ± konulu yazÄ±sÄ±ndan faydalanÄ±lmÄ±ÅŸtÄ±r.\n","wordCount":"1294","inLanguage":"tr","datePublished":"2022-03-20T00:00:00Z","dateModified":"2024-04-16T22:17:43+02:00","author":{"@type":"Person","name":"Wise"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wiseweb-works.github.io/blog/post/ecc-ssl-sertifikasi/"},"publisher":{"@type":"Organization","name":"Wise","logo":{"@type":"ImageObject","url":"https://wiseweb-works.github.io/blog/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wiseweb-works.github.io/blog/ accesskey=h title="Wise (Alt + H)">Wise</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://wiseweb-works.github.io/blog/en/ title=English aria-label=:gb:>ğŸ‡¬ğŸ‡§</a></li><li><a href=https://wiseweb-works.github.io/blog/de/ title=Deutsch aria-label=:de:>ğŸ‡©ğŸ‡ª</a></li></ul></div></div><ul id=menu><li><a href=https://wiseweb-works.github.io/blog/ title=Anasayfa><span>Anasayfa</span></a></li><li><a href=https://wiseweb-works.github.io/blog/post/ title=Blog><span>Blog</span></a></li><li><a href=https://wiseweb-works.github.io/blog/page/iletisim/ title=Ä°letiÅŸim><span>Ä°letiÅŸim</span></a></li><li><a href=https://wiseweb-works.github.io/blog/tags/ title=Etiketler><span>Etiketler</span></a></li><li><a href=https://wiseweb-works.github.io/blog/archives/ title=ArÅŸiv><span>ArÅŸiv</span></a></li><li><a href=https://wiseweb-works.github.io/blog/search/ title="Ara ğŸ”"><span>Ara ğŸ”</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Linux Sunucuda ECC SSL SertifikasÄ± Ãœretme</h1><div class=post-meta><span title='2022-03-20 00:00:00 +0000 UTC'>20 Mart, 2022</span>&nbsp;Â·&nbsp;<span title='2024-04-16 22:17:43 +0200 +0200'>(Updated 16 Nisan, 2024)</span>&nbsp;Â·&nbsp;7 dk&nbsp;Â·&nbsp;1294 kelime&nbsp;Â·&nbsp;Wise&nbsp;|&nbsp;Ã‡eviriler:<ul class=i18n_list><li><a href=https://wiseweb-works.github.io/blog/en/post/ecc-ssl-sertifikasi/>ğŸ‡¬ğŸ‡§</a></li><li><a href=https://wiseweb-works.github.io/blog/de/post/ecc-ssl-sertifikasi/>ğŸ‡©ğŸ‡ª</a></li></ul>&nbsp;|&nbsp;<a href=https://github.com/wiseweb-works/blog/tree/master/content/post/ecc-ssl-sertifikasi.md rel="noopener noreferrer" target=_blank>DÃ¼zenle</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Ä°Ã§indekiler</span></summary><div class=inner><ul><li><a href=#giri%c5%9f-ve-%c3%b6zet aria-label="GiriÅŸ ve Ã–zet">GiriÅŸ ve Ã–zet</a><ul><li><a href=#ecc-sertifikas%c4%b1n%c4%b1n-%c3%bcretim-s%c3%bcreci aria-label="ECC SertifikasÄ±nÄ±n Ã¼retim sÃ¼reci">ECC SertifikasÄ±nÄ±n Ã¼retim sÃ¼reci</a></li><li><a href=#%c3%b6zel-anahtar%c4%b1-olu%c5%9ftural%c4%b1m aria-label="Ã–zel anahtarÄ± oluÅŸturalÄ±m">Ã–zel anahtarÄ± oluÅŸturalÄ±m</a></li><li><a href=#sertifika-i%c3%a7in-openssl-yap%c4%b1land%c4%b1rmas%c4%b1-olu%c5%9ftural%c4%b1m aria-label="Sertifika iÃ§in OpenSSL yapÄ±landÄ±rmasÄ± oluÅŸturalÄ±m">Sertifika iÃ§in OpenSSL yapÄ±landÄ±rmasÄ± oluÅŸturalÄ±m</a></li><li><a href=#sertifika-imzalama-iste%c4%9fi-olu%c5%9ftural%c4%b1m aria-label="Sertifika Ä°mzalama Ä°steÄŸi OluÅŸturalÄ±m">Sertifika Ä°mzalama Ä°steÄŸi OluÅŸturalÄ±m</a></li><li><a href=#lets-encryptten-sertifikam%c4%b1z%c4%b1-imzalamas%c4%b1n%c4%b1-isteyin aria-label="Let&rsquo;s Encrypt&rsquo;ten sertifikamÄ±zÄ± imzalamasÄ±nÄ± isteyin">Let&rsquo;s Encrypt&rsquo;ten sertifikamÄ±zÄ± imzalamasÄ±nÄ± isteyin</a></li></ul></li><li><a href=#son aria-label=SON>SON</a></li></ul></div></details></div><div class=post-content><h1 id=giriÅŸ-ve-Ã¶zet>GiriÅŸ ve Ã–zet<a hidden class=anchor aria-hidden=true href=#giriÅŸ-ve-Ã¶zet>#</a></h1><p>BugÃ¼n sizlerle yÃ¶nettiÄŸiniz bir web sitesi veya uygulama sunucusu ile ziyaretÃ§ileriniz arasÄ±ndaki trafiÄŸin gizli/gÃ¼venilir ve doÄŸrulanabilir olmasÄ±nÄ± saÄŸlamak iÃ§in SSL sertifikasÄ± Ã¼retmeyi Ã¶ÄŸreneceÄŸiz. ÃœrettiÄŸiniz sertifikayÄ± nasÄ±l ve hangi konfigÃ¼rasyon ile deploy edeceÄŸinizi Ã¶nceki yazÄ±larÄ±mda anlatmÄ±ÅŸtÄ±m. Bu yazÄ±da ise az ekmek Ã§ok kÃ¶fte denklemini nasÄ±l kurabileceÄŸimizi yani daha hÄ±zlÄ± ve daha gÃ¼venli bir SSL sertifikasÄ± Ã¼retmeyi gÃ¶stereceÄŸim. Normalde Let&rsquo;s Encrypt&rsquo;in ACME protokolÃ¼ne aÅŸina iseniz (yazÄ±nÄ±n yazÄ±ldÄ±ÄŸÄ± tarih itibariyle) RSA asimetrik anahtar yapÄ±sÄ± ile 1024-4098 (Ã§ok zorlarsanÄ±z belki 8196) bitlik bir sertifika Ã¼rettirmeniz ve bunu gÃ¶rece olarak 90 gÃ¼n kullanmanÄ±z mÃ¼mkÃ¼ndÃ¼r. Fakat bu kadar bÃ¼yÃ¼k bir anahtarÄ±n Ã¼retilmesi, Ã¼rettikten sonra TLS handshake sÄ±rasÄ±nda kullanÄ±lmasÄ± ve ziyaretÃ§ilerin kullandÄ±ÄŸÄ± cihazlar ile uyumlu olmasÄ± Ã§oÄŸu senaryoda sorun Ã§Ä±karmaktadÄ±r. Ã–rneÄŸin 2048 bit yerine 4096 bit kullanÄ±ldÄ±ÄŸÄ± zaman bazÄ± denemelerimde 0.4-0.8 sn daha uzun handshake sÃ¼releri ile karÅŸÄ± karÅŸÄ±ya kalÄ±yorum. Sadece handshake in bu kadar uzamasÄ± sorun deÄŸilmiÅŸ gibi sunucuya da ekstra bir yÃ¼k bindiriyor. Fakat 4096 bit RSA yerine 384 bit ECC sertifikasÄ± Ã¼rettiÄŸiniz zaman Ã§ok daha hÄ±zlÄ± bir sertifikaya sahip olduÄŸunuz gibi aynÄ± zamanda da 7680 bit RSA&rsquo;ya (Ã¶yle bir boyut olsaydÄ±) eÅŸit bir gÃ¼venlik elde ediyorsunuz.</p><p>Peki iyi gÃ¼zel anlattÄ±n da bu iÅŸin amasÄ± nerede dediÄŸinizi duyar gibiyim. Sizi Ã¼zeceÄŸim fakat bu iÅŸin amasÄ± yok. OlmamasÄ±nÄ±n sebebi ise iÅŸin arka plandaki matematikte saklÄ±. KÄ±saca her iki sertifika Ã¼retim ve kullanÄ±mÄ±ndaki ufak farklardan bahsedip, bunlarÄ±n nasÄ±l ve neden bÃ¼yÃ¼k farklara neden olduÄŸunu aÃ§Ä±klayÄ±p son kÄ±sÄ±mda da bonus olarak baÅŸlÄ±kta yazmayan bir ÅŸeyden bahsedeceÄŸim. (Sonuna kadar okumanÄ±z gerekecek bonus iÃ§in :D)</p><p><picture><source srcset=https://wiseweb-works.github.io/blog/images/ecc-ssl/key-size-comparison.avif type=image/avif><source srcset=https://wiseweb-works.github.io/blog/images/ecc-ssl/key-size-comparison.webp type=image/webp><img src=https://wiseweb-works.github.io/blog/images/ecc-ssl/key-size-comparison.jpg loading=lazy decoding=async width=min(100%, 720px) height=auto><center><small><b>https://www.globalsign.com/en/blog/elliptic-curve-cryptography (EriÅŸim Tarihi: 08.04.2023)</b></small></center></picture></p><h2 id=ecc-sertifikasÄ±nÄ±n-Ã¼retim-sÃ¼reci>ECC SertifikasÄ±nÄ±n Ã¼retim sÃ¼reci<a hidden class=anchor aria-hidden=true href=#ecc-sertifikasÄ±nÄ±n-Ã¼retim-sÃ¼reci>#</a></h2><p>Ã–ncelikle (her zaman olduÄŸu gibi) iÃ§inde bulunduÄŸumuz Linux sÃ¼rÃ¼mÃ¼nÃ¼n paket yÃ¶neticisi ile son gÃ¼ncellemeleri konsol Ã¼zerinden yÃ¼klememiz gerekmektedir.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Ubuntu iÃ§in: sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt upgrade -y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Fedora iÃ§in: sudo yum update -y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Arch Linux iÃ§in: sudo pacman -Syyu
</span></span></code></pre></div><p>GÃ¼ncellemeler yÃ¼klendikten sonra ise sunucunuzdaki (Benim olayÄ±mda Ubuntu) nginx servisini (ki bu servis dÄ±ÅŸarÄ±dan HTTP/HTTPS baÄŸlantÄ±larÄ± almanÄ±za yarayan servistir) yapÄ±landÄ±rmaya baÅŸlÄ±yoruz. Ã–ncelikle Ã§ok karÄ±ÅŸtÄ±rÄ±lmasÄ± nedeniyle belirtmek gerekir ki apache, nginx ve litespeed servisleri aynÄ± iÅŸi yapan farklÄ± servislerdir. Ben yÃ¶netimi daha kolay ve topluluk desteÄŸi daha Ã§ok diye NGINX&rsquo;i terchi ettim.</p><h2 id=Ã¶zel-anahtarÄ±-oluÅŸturalÄ±m>Ã–zel anahtarÄ± oluÅŸturalÄ±m<a hidden class=anchor aria-hidden=true href=#Ã¶zel-anahtarÄ±-oluÅŸturalÄ±m>#</a></h2><p>Ä°lk olarak, OpenSSL ile Ã¶zel anahtarÄ± oluÅŸturuyoruz. KullanacaÄŸÄ±mÄ±z OpenSSL komutu <code>ecparam</code> (EC parametre manipÃ¼lasyonu) ve konfigÃ¼rasyon parametrelerini bu komuta geÃ§irmek iÃ§in:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl ecparam -genkey -name secp384r1 -out privkey.pem
</span></span></code></pre></div><ul><li><code>-genkey</code> seÃ§eneÄŸi, OpenSSL&rsquo;ye bir EC anahtarÄ± oluÅŸturmasÄ±nÄ± sÃ¶yler.</li><li><code>-name</code> parametresi OpenSSL&rsquo;ye hangi eÄŸrinin kullanÄ±lacaÄŸÄ±nÄ± sÃ¶yler.</li><li><code>-out</code> parametresi OpenSSL&rsquo;ye Ã§Ä±ktÄ±yÄ± bir dosyaya yazmasÄ±nÄ± sÃ¶yler.</li></ul><p>OpenSSL&rsquo;nin Ã§Ä±ktÄ±sÄ±nÄ± varsayÄ±lan olarak PEM biÃ§iminde yazdÄ±ÄŸÄ±nÄ± unutmayÄ±n. EC anahtarlarÄ±nÄ± iÅŸleyen <code>ec</code> komutuyla OpenSSL&rsquo;nin doÄŸru ÅŸeyi yaptÄ±ÄŸÄ±nÄ± kontrol edebiliriz:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl ec -in privkey.pem -noout -text
</span></span></code></pre></div><ul><li><code>-in</code> girdi dosyasÄ±dÄ±r</li><li><code>-noout</code>, OpenSSL&rsquo;ye anahtarÄ± Ã§Ä±karmamasÄ±nÄ± sÃ¶yler, bu da privkey.pem&rsquo;i stdout&rsquo;a anlamsÄ±zca yazdÄ±rÄ±r.</li><li><code>-text</code>, OpenSSL&rsquo;ye anahtar hakkÄ±ndaki bilgileri dÃ¼z metin biÃ§iminde yazmasÄ±nÄ± sÃ¶yler</li></ul><p>Her ÅŸey yolunda giderse ve anahtar doÄŸru ÅŸekilde oluÅŸturulduysa, OpenSSL aÅŸaÄŸÄ±dakine benzer bir ÅŸey gÃ¶sterecektir:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>read EC key
</span></span><span style=display:flex><span>Private-Key: (384 bit)
</span></span><span style=display:flex><span>priv:
</span></span><span style=display:flex><span>    [gizli]
</span></span><span style=display:flex><span>pub:
</span></span><span style=display:flex><span>    [gizli]
</span></span><span style=display:flex><span>ASN1 OID: secp384r1
</span></span><span style=display:flex><span>NIST CURVE: P-384
</span></span></code></pre></div><p>Bu, anahtarÄ±n P-384 eÄŸrisi ile oluÅŸturulduÄŸunu doÄŸrular. Neden P-384 yerine P-512 kullanmÄ±yoruz derseniz Let&rsquo;s Encrypt ekliptik eÄŸrilerde 384 bitten daha yÃ¼ksek olursa imzalamÄ±yor ve Google Chrome gibi modern tarayÄ±cÄ±lar 512 bitlik ekliptik eÄŸrileri kullanan internet sitelerini geÃ§ersiz olarak iÅŸaretliyor. KÄ±sa cevap bu.</p><h2 id=sertifika-iÃ§in-openssl-yapÄ±landÄ±rmasÄ±-oluÅŸturalÄ±m>Sertifika iÃ§in OpenSSL yapÄ±landÄ±rmasÄ± oluÅŸturalÄ±m<a hidden class=anchor aria-hidden=true href=#sertifika-iÃ§in-openssl-yapÄ±landÄ±rmasÄ±-oluÅŸturalÄ±m>#</a></h2><p>Åimdi TLS sertifikasÄ± almak istediÄŸimiz etki alanÄ±na Ã¶zgÃ¼ parametreleri iÃ§eren bir OpenSSL yapÄ±landÄ±rma dosyasÄ± oluÅŸturmalÄ±yÄ±z. Bu Ã¶rnekte, bir <code>openssl.cnf</code> dosyasÄ±na aÅŸaÄŸÄ±daki konfigÃ¼rasyonu gireceÄŸiz:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>[ req ]
</span></span><span style=display:flex><span>prompt = no
</span></span><span style=display:flex><span>encrypt_key = no
</span></span><span style=display:flex><span>default_md = sha512
</span></span><span style=display:flex><span>distinguished_name = dname
</span></span><span style=display:flex><span>req_extensions = reqext
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[ dname ]
</span></span><span style=display:flex><span>CN = example.com
</span></span><span style=display:flex><span>emailAddress = admin@example.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[ reqext ]
</span></span><span style=display:flex><span>subjectAltName = DNS:example.com, DNS:www.example.com
</span></span></code></pre></div><p>Bu yapÄ±landÄ±rma seÃ§eneklerinin kÄ±sa bir aÃ§Ä±klamasÄ±:</p><p>Gerekli <code>[ req ]</code> bÃ¶lÃ¼mÃ¼nde:</p><ul><li><code>prompt = no</code>, OpenSSL&rsquo;ye yapÄ±landÄ±rma dosyasÄ±ndan olabildiÄŸince fazla yapÄ±landÄ±rma almasÄ±nÄ± sÃ¶yler</li><li><code>encrypt_key = no</code>, OpenSSL&rsquo;ye Ã¶zel anahtarÄ± bir parola ile ÅŸifrelememesini sÃ¶yler. (Åifreli Ã¶zel anahtarlar Nginx tarafÄ±ndan desteklenir, ancak ben onlarÄ± kullanmÄ±yorum.)</li><li><code>default_md = sha512</code>, OpenSSL&rsquo;ye CSR&rsquo;yi SHA512 ile imzalamasÄ±nÄ± sÃ¶yler. (BildiÄŸim kadarÄ±yla, Let&rsquo;s Encrypt, imzalarÄ± iÃ§in yalnÄ±zca SHA256&rsquo;lÄ± RSA&rsquo;yÄ± destekler, ancak bu, CSR&rsquo;de daha gÃ¼Ã§lÃ¼ ÅŸifreleme kullanamayacaÄŸÄ±mÄ±z anlamÄ±na gelmez.)</li><li><code>distinguished_name = dname</code>, OpenSSL&rsquo;ye AyÄ±rt Edici Ad yapÄ±landÄ±rma seÃ§enekleri iÃ§in bir <code>[ dname ]</code> bÃ¶lÃ¼mÃ¼ aramasÄ±nÄ± sÃ¶yler.</li><li><code>req_extensions = reqext</code>, OpenSSL&rsquo;ye, Konu Alternatif AdlarÄ±nÄ±n (SAN&rsquo;lar) yapÄ±landÄ±rÄ±lmak istenen uzantÄ±lar iÃ§in yapÄ±landÄ±rma seÃ§eneklerinde bir <code>[ reqext ]</code> bÃ¶lÃ¼mÃ¼ aramasÄ±nÄ± sÃ¶yler.</li></ul><p>AyÄ±rt Edici Ad <code>[ dname ]</code> bÃ¶lÃ¼mÃ¼nde:</p><ul><li><code>CN = example.com</code>, sertifikanÄ±n Ortak AdÄ±nÄ± belirtir.</li><li><code>emailAddress = admin@example.com</code> e-posta adresiniz belirgin olmalÄ±dÄ±r.
Ä°stenen UzantÄ±lar <code>[ reqext ]</code> bÃ¶lÃ¼mÃ¼nde, konuAltName, sertifika iÃ§in SAN&rsquo;larÄ±n listesini saÄŸlar. (Chrome, v58&rsquo;den itibaren, Ortak AdÄ±n SAN&rsquo;lar listesine dahil edilmesini gerektirir).</li></ul><p>Let&rsquo;s Encrypt v2, joker alan adlarÄ±nÄ± destekler, bu nedenle bu Ã¶rnekte, apeks dÄ±ÅŸÄ±ndaki ana bilgisayarlar iÃ§in tek dÃ¼zeyli bir joker karakter kullanabilirsiniz (*.example.com).</p><h2 id=sertifika-imzalama-isteÄŸi-oluÅŸturalÄ±m>Sertifika Ä°mzalama Ä°steÄŸi OluÅŸturalÄ±m<a hidden class=anchor aria-hidden=true href=#sertifika-imzalama-isteÄŸi-oluÅŸturalÄ±m>#</a></h2><p>Ä°stemci tarafÄ±ndaki son adÄ±m, OpenSSL kullanarak Sertifika Ä°mzalama Talebi oluÅŸturmaktÄ±r, ardÄ±ndan bunu imzalamak iÃ§in Let&rsquo;s Encrypt&rsquo;e ileteceÄŸiz ve imzalÄ± sertifikayÄ± geri alacaÄŸÄ±z.</p><p>Bir CSR oluÅŸturmak iÃ§in gereken OpenSSL komutu <code>req</code> &lsquo;dir.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl req -new -config openssl.cnf -key privkey.pem -out csr.pem
</span></span></code></pre></div><ul><li><code>-new</code>, OpenSSL&rsquo;ye bir CSR oluÅŸturduÄŸumuzu sÃ¶yler (ve mevcut bir CSR&rsquo;yi incelemeyiz)</li><li><code>-config</code> openssl.cnf, yukarÄ±da oluÅŸturduÄŸumuz yapÄ±landÄ±rma dosyasÄ±nÄ± belirtir</li><li><code>-key privkey.pem</code>, yukarÄ±da oluÅŸturduÄŸumuz Ã¶zel anahtarÄ± belirtir</li><li><code>-out csr.pem</code> OpenSSL&rsquo;ye CSR&rsquo;yi bir Ã§Ä±ktÄ± dosyasÄ±na yazmasÄ±nÄ± sÃ¶yler (stdout yerine)</li></ul><p>CSR&rsquo;yi doÄŸru ÅŸekilde oluÅŸturduÄŸumuzu doÄŸrulayabiliriz:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl req -in csr.pem -noout -text -verify
</span></span></code></pre></div><ul><li><code>-verify</code> OpenSSL&rsquo;nin CSR&rsquo;deki imzayÄ± doÄŸrulamasÄ±nÄ± ister</li></ul><p>Bu, Ã§Ä±ktÄ±da beklenen ÅŸu sonuÃ§larÄ± Ã¼retmelidir:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>verify OK
</span></span><span style=display:flex><span>Certificate Request:
</span></span><span style=display:flex><span>    Data:
</span></span><span style=display:flex><span>        Version: 1 (0x0)
</span></span><span style=display:flex><span>        Subject: CN = example.com, emailAddress = admin@example.com
</span></span><span style=display:flex><span>        Subject Public Key Info:
</span></span><span style=display:flex><span>            Public Key Algorithm: id-ecPublicKey
</span></span><span style=display:flex><span>                Public-Key: (384 bit)
</span></span><span style=display:flex><span>                pub:
</span></span><span style=display:flex><span>                    [gizli]
</span></span><span style=display:flex><span>                ASN1 OID: secp384r1
</span></span><span style=display:flex><span>                NIST CURVE: P-384
</span></span><span style=display:flex><span>        Attributes:
</span></span><span style=display:flex><span>        Requested Extensions:
</span></span><span style=display:flex><span>            X509v3 Subject Alternative Name:
</span></span><span style=display:flex><span>                DNS:example.com, DNS:www.example.com
</span></span><span style=display:flex><span>    Signature Algorithm: ecdsa-with-SHA512
</span></span><span style=display:flex><span>         [gizli]
</span></span></code></pre></div><h2 id=lets-encryptten-sertifikamÄ±zÄ±-imzalamasÄ±nÄ±-isteyin>Let&rsquo;s Encrypt&rsquo;ten sertifikamÄ±zÄ± imzalamasÄ±nÄ± isteyin<a hidden class=anchor aria-hidden=true href=#lets-encryptten-sertifikamÄ±zÄ±-imzalamasÄ±nÄ±-isteyin>#</a></h2><p>Son adÄ±m, CSR&rsquo;yi bir ACME istemcisiyle Let&rsquo;s Encrypt&rsquo;e imzalamasÄ± iÃ§in gÃ¶ndermektir, bu iÅŸ iÃ§in <code>certbot</code> en yaygÄ±n istemcidir.</p><p><code>Certbot</code> istemcisine iletilen komut satÄ±rÄ± seÃ§enekleri, kurulumumuza, alan adÄ±mÄ±zÄ±n kayÄ±tlÄ± olduÄŸu kiÅŸiye vb. baÄŸlÄ± olarak deÄŸiÅŸir. Genellikle <code>certonly</code> komutunu kullanmamÄ±z gerekir ve asterisks (*) kullandÄ±ysanÄ±z certbot DNS eklentilerinden birini kullanmanÄ±z gerekir.</p><p>Ã–rneÄŸin, <code>example.com</code> alan adÄ± Cloudflare&rsquo;de kayÄ±tlÄ±ysa, son derece uygun olan ve sÃ¼rece manuel mÃ¼dahale gerektirmeyen doÄŸrulamayÄ± iÅŸlemek iÃ§in ilgili eklentiyi kullanabiliriz. (Cloudflare eklentisini gizli token bilgileriyle yapÄ±landÄ±rmak bu makalenin kapsamÄ± dÄ±ÅŸÄ±ndadÄ±r.)</p><p>Her ÅŸeyin yolunda olduÄŸundan emin olmak iÃ§in Ã¶nce <code>--dry-run</code> ile dÃ¼zgÃ¼n sonuÃ§ alÄ±nacaÄŸÄ±ndan emin olunmasÄ± genellikle tavsiye edilir.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>certbot nginx certonly --dry-run --domain <span style=color:#e6db74>&#34;example.com&#34;</span> --domain <span style=color:#e6db74>&#34;www.example.com&#34;</span> --csr csr.pem
</span></span></code></pre></div><ul><li>HatalÄ± iÅŸlemeleri Ã¶nlemek iÃ§in karakterlerin etrafÄ±nda tÄ±rnak iÅŸaretleri gereklidir ve genel olarak bunlar iyi bir fikirdir.</li><li><code>--csr csr.pem</code> certbot&rsquo;a zaten bir sertifikamÄ±z olduÄŸunu ve bizim iÃ§in imzalamasÄ± iÃ§in Let&rsquo;s Encrypt&rsquo;e ihtiyacÄ±mÄ±z olduÄŸunu sÃ¶yler.</li></ul><p>Certbot istemcisi, komut satÄ±rÄ±nda istenen alan adlarÄ± listesinin sertifikada listelenen alan adlarÄ±yla eÅŸleÅŸip eÅŸleÅŸmediÄŸini kontrol edecek ve alan adÄ±nÄ±n bize ait olduÄŸunu doÄŸrulamak iÃ§in Certbot NGINX eklentisini kullanacak ve herhangi bir sorun olup olmadÄ±ÄŸÄ±nÄ± bize bildirecektir.</p><p>HiÃ§bir ÅŸey yanlÄ±ÅŸ deÄŸilse, size ÅŸunu sÃ¶yleyecektir:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>IMPORTANT NOTES:
</span></span><span style=display:flex><span> - The dry run was successful.
</span></span></code></pre></div><p>GerÃ§ek komut hemen aÅŸaÄŸÄ±daki gibidir:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>certbot nginx certonly --domain <span style=color:#e6db74>&#34;example.com&#34;</span> --domain <span style=color:#e6db74>&#34;www.example.com&#34;</span> --csr csr.pem
</span></span></code></pre></div><p>(Uzun) bir gecikmeden sonra, istemci Ã§Ä±ktÄ± olarak ÅŸunlarÄ± Ã¼retecektir:</p><ol><li>Ä°mzalÄ± sertifika: <code>0000_cert.pem</code></li><li>KÃ¶k ve ara sertifikalar: <code>0000_chain.pem</code></li><li>Sertifika + ara Ã¼rÃ¼nler: <code>0001_chain.pem</code>
Bu noktada, CSR <code>csr.pem</code> silinebilir.</li></ol><p>Merak ediyorsak, <code>x509</code> komutunu kullanarak istemci tarafÄ±ndan OpenSSL ile dÃ¶ndÃ¼rÃ¼len sertifikalarÄ± inceleyebiliriz:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl x509 -in 0001_chain.pem -noout -text
</span></span></code></pre></div><p>Ne yazÄ±k ki, yukarÄ±da aÃ§Ä±klandÄ±ÄŸÄ± gibi Let&rsquo;s Encrypt&rsquo;in sertifikamÄ±zÄ± bir SHA256 imzasÄ±yla imzaladÄ±ÄŸÄ±nÄ± keÅŸfedeceÄŸiz. (Daha gÃ¼venli olmasÄ±nÄ±n yanÄ± sÄ±ra, SHA512, modern 64-bit CPU&rsquo;larda SHA256&rsquo;dan daha iyi performans gÃ¶sterir.) Ancak aÃ§Ä±k anahtarÄ±mÄ±z yine de ECDSA kullanmalÄ±dÄ±r.</p><p>Bu dosyalar sÄ±radan deÄŸildir, bu yÃ¼zden onlarÄ± daha bilgilendirici bir ÅŸekilde taÅŸÄ±malÄ± ve dÃ¼zenlemeliyiz.</p><p>Debian Linux&rsquo;ta, Ã¶zel anahtarÄ±mÄ± <code>/home/KULLANICI_ADI/SSL/private/example.com/privkey.pem</code> iÃ§inde tutarak etki alanlarÄ±m iÃ§in alt dizinler oluÅŸturmayÄ± seviyorum ve sertifikalar:</p><ul><li><code>/home/KULLANICI_ADI/SSL/certs/example.com/cert.pem</code></li><li><code>/home/KULLANICI_ADI/SSL/certs/example.com/chain.pem</code></li><li><code>/home/KULLANICI_ADI/SSL/certs/example.com/fullchain.pem</code></li></ul><h1 id=son>SON<a hidden class=anchor aria-hidden=true href=#son>#</a></h1><p>Her ÅŸeyi doÄŸru yaptÄ±ysak, sertifikayÄ± Chrome gibi bir web tarayÄ±cÄ±sÄ± ile incelediÄŸimizde, bunun bir EC sertifikasÄ± olduÄŸunu onaylayacaktÄ±r:</p><p><picture><source srcset=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-sll-key-chrome.avif type=image/avif><source srcset=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-sll-key-chrome.webp type=image/webp><img src=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-sll-key-chrome.png loading=lazy decoding=async width=min(100%, 720px) height=auto><center><small><b>https://dev.to/benjaminblack/obtaining-an-elliptic-curve-dsa-certificate-with-lets-encrypt-51bc (EriÅŸim Tarihi: 08.04.2023)</b></small></center></picture></p><p>Mozilla GÃ¶zlemevi de bize A+ notu verecek!</p><p><picture><source srcset=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-ssl-key-mozilla.avif type=image/avif><source srcset=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-ssl-key-mozilla.webp type=image/webp><img src=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-ssl-key-mozilla.png loading=lazy decoding=async width=min(100%, 720px) height=auto><center><small><b>https://dev.to/benjaminblack/obtaining-an-elliptic-curve-dsa-certificate-with-lets-encrypt-51bc (EriÅŸim Tarihi: 08.04.2023)</b></small></center></picture></p><p>AyrÄ±ca SSL Labs&rsquo;Ä±n rapor sonucunda 384 Bitlik bir ECC sertifikasÄ±&rsquo;nÄ±n kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rebiliyoruz.</p><p><picture><source srcset=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-ssl-key-ssllabs.avif type=image/avif><source srcset=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-ssl-key-ssllabs.webp type=image/webp><img src=https://wiseweb-works.github.io/blog/images/ecc-ssl/ecc-ssl-key-ssllabs.png loading=lazy decoding=async width=min(100%, 720px) height=auto><center><small><b>SSL Labs Test Sonucu</b></small></center></picture></p><p>NOT: Bu yazÄ±da <a href=https://dev.to/benjaminblack/obtaining-an-elliptic-curve-dsa-certificate-with-lets-encrypt-51bc>Benjamin Black</a>&lsquo;in aynÄ± konulu yazÄ±sÄ±ndan faydalanÄ±lmÄ±ÅŸtÄ±r.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wiseweb-works.github.io/blog/tags/linux/>Linux</a></li><li><a href=https://wiseweb-works.github.io/blog/tags/ssl/>Ssl</a></li><li><a href=https://wiseweb-works.github.io/blog/tags/security/>Security</a></li><li><a href=https://wiseweb-works.github.io/blog/tags/ecc/>Ecc</a></li><li><a href=https://wiseweb-works.github.io/blog/tags/elliptic-curve/>Elliptic Curve</a></li></ul><nav class=paginav><a class=prev href=https://wiseweb-works.github.io/blog/post/openvpn-full-anlatim/><span class=title>Â« Ã–nceki</span><br><span>OpenVPN Derinlemesine AnlatÄ±m</span>
</a><a class=next href=https://wiseweb-works.github.io/blog/post/ssl-konfigurasyonu/><span class=title>Sonraki Â»</span><br><span>Linux Sunucularda SSL gÃ¼venliÄŸini arttÄ±rma</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://wiseweb-works.github.io/blog/>Wise</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopyala";function s(){t.innerHTML="KopyalandÄ±!",setTimeout(()=>{t.innerHTML="Kopyala"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>